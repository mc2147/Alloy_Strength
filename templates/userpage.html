<!-- {% load static %} -->
<!DOCTYPE html>
<html lang="en">


<!-- Include Vue.js Source Code -->
<script src='https://unpkg.com/vue'></script>
<!-- <script src="https://code.getmdl.io/1.3.0/material.min.js"></script> -->


<!-- Include HTML Code -->
<!-- Head --> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>


    <!-- Material Design code -->
    <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> -->
    <!--   <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue_grey-indigo.min.css"> -->
  
    <!-- Style Sheets -->
    <link rel="stylesheet" href="{% static 'userpage/userpage.css' %}">
    <link href="https://fonts.googleapis.com/css?family=Cabin:400,600,700" rel="stylesheet">

    <title>User Page</title>

</head>


<!-- Body --> 
<body>
    <h1>Welcome, athlete!</h1>
    <hr>

    <img src='{% static "userpage/user_interface.svg" %}'>


</head>
<body>

    <div id="left_container">
        <div id="date_text_container">
            <p> Date: </p>
            <p id="date_text"><p>
        </div>

        <hr id='dummy_divider'>

        <div id="datepicker"></div>
        <div id="summary">Content goes here</div>

    </div>

    <div id='right_container'>
        <table class='table_calendar'>
            <tr>
                <th class='table_header'>Pattern</th>
                <th class='table_header'>Level</th>
                <th class='table_header'>Exercise</th>
                <th class='table_header'>Reps</th>
                <th class='table_header'>Weight</th>
                <th class='table_header'>RPE</th>
                <th class='table_header'>Tempo</th>
            </tr>

            <tr class='table_content'>
                <th>${ row1.exercise_type }</th>
                <td><div>${ row1.level }</div></td>
                <td><div>${ row1.exercise_name }</div></td>
                <td><div>${ row1.reps }</div></td>
                <td><div></div></td>
                <td><div></div></td>
                <td><div></div></td>
            </tr>

            <tr class='table_content'>
                <th>${ row2.exercise_type }</th>
                <td><div>${ row2.level }</div></td>
                <td><div>${ row2.exercise_name }</div></td>
                <td><div>${ row2.reps }</div></td>
                <td><div></div></td>
                <td><div></div></td>
                <td><div></div></td>
            </tr>

            <tr class='table_content'>
                <th>${row3.exercise_type}</th>
                <td><div>${ row3.level }</div></td>
                <td><div>${ row3.exercise_name }</div></td>
                <td><div>${ row3.reps }</div></td>
                <td><div></div></td>
                <td><div></div></td>
                <td><div></div></td>
            </tr>

            <tr class='table_content'>
                <th>${ row4.exercise_type}</th>
                <td><div>${ row4.level }</div></td>
                <td><div>${ row4.exercise_name }</div></td>
                <td><div>${ row4.reps }</div></td>
                <td><div></div></td>
                <td><div></div></td>
                <td><div></div></td>
            </tr>

            <tr class='table_content'>
                <th>${ row5.exercise_type}</th>
                <td><div>${ row5.level }</div></td>
                <td><div>${ row5.exercise_name }</div></td>
                <td><div>${ row5.reps }</div></td>
                <td><div></div></td>
                <td><div></div></td>
                <td><div></div></td>
            </tr>

        </table>
    </div>

</body>

</html>


<script>


   $('#datepicker').datepicker({
        beforeShow: function(input, inst) {
            if ($('#ui-datepicker-div .ui-datepicker-calendar').is(':visible')) {
                console.log("The calendar is visible"); 
            }
        }
    });



    $('#datepicker').each(function() {
        console.log("I'm in here!"); 
    });

    // use 'safe' for json 
    var final_list = {{ final_list | safe }};
    console.log(final_list); 
    console.log(typeof parseInt("01", 10).toString()); 

    var final_list_len = final_list.length; 

    for (i = 0; i < final_list_len; i++) {
        var final_list_date = final_list[i]; 
        var month = parseInt(final_list_date.month, 10).toString(); 
        var month_zero_index = (parseInt(final_list_date.month, 10) - 1).toString(); 
        var day = parseInt(final_list_date.day, 10).toString(); 
        var year = parseInt(final_list_date.year, 10).toString(); 
        $('[data-year=' + year + '][data-month=' + 
            month_zero_index + ']').each(function() {
            if ($(this).children('.ui-state-default').text() == day) {
                $(this).children('.ui-state-default').css('background-color', 'cornflowerblue'); 
            }
        })
    }

    // $('[data-year]').each(function() {
    //     console.log($(this).attr('data-year'));
    //     console.log($(this).attr('data-month')); 
    //     console.log($(this).children('.ui-state-default').text()); 
    // });

    

    var vm = new Vue({
        el: '.table_calendar',
        delimiters: ['${', '}'],
        data: {
            // pattern: "pattern",
            // level: "level", 
            // exercise: "exercise", 
            // weight: "weight", 
            // rpe: "rpe", 
            // tempo: "tempo"
            row1: {
                'level': '',
                'exercise_type': '',
                'exercise_name': '',
                'sets': '',
                'reps': '',
                'date': ''
            },
            row2: {
                'level': '',
                'exercise_type': '',
                'exercise_name': '',
                'sets': '',
                'reps': '',
                'date': ''
            },
            row3: {
                'level': '',
                'exercise_type': '',
                'exercise_name': '',
                'sets': '',
                'reps': '',
                'date': ''
            },
            row4: {
                'level': '',
                'exercise_type': '',
                'exercise_name': '',
                'sets': '',
                'reps': '',
                'date': ''
            },
            row5: {
                'level': '',
                'exercise_type': '',
                'exercise_name': '',
                'sets': '',
                'reps': '',
                'date': ''
            }
        }
    });

    console.log(vm); 

    $( function() {
        $( "#datepicker" ).datepicker();

        var currentDate = $( "#datepicker" ).val()

        $( "#date_text" ).text(currentDate);

        // Get selected date
        // reference: https://stackoverflow.com/questions/26667720/how-to-get-the-selected-date-from-jquery-datepicker

        console.log(currentDate);

        var URL = "{% url 'userpageUpdate' %}";


        function updateTempDate(){
            var TempDate = $( "#date_text" ).text(); 
            var data = {'TempDate': TempDate};
            console.log("I'm in updateTempDate"); 
            $.post(URL, data, function(response){
                // console.log(response); 
                // console.log(JSON.stringify(response));
                response1 = response[0];
                console.log(response1); 
                vm.row1.exercise_type = response1.exercise_type;
                vm.row1.level = response1.level;
                vm.row1.exercise_name = response1.exercise_name; 
                vm.row1.reps = response1.reps;


                response2 = response[1];
                vm.row2.exercise_type = response2.exercise_type;
                vm.row2.level = response2.level;
                vm.row2.exercise_name = response2.exercise_name; 
                vm.row2.reps = response2.reps;


                response3 = response[2];
                vm.row3.exercise_type = response3.exercise_type;
                vm.row3.level = response3.level;
                vm.row3.exercise_name = response3.exercise_name; 
                vm.row3.reps = response3.reps;


                response4 = response[3];
                vm.row4.exercise_type = response4.exercise_type;
                vm.row4.level = response4.level;
                vm.row4.exercise_name = response4.exercise_name; 
                vm.row4.reps = response4.reps;


                response5 = response[4];
                vm.row5.exercise_type = response5.exercise_type;
                vm.row5.level = response5.level;
                vm.row5.exercise_name = response5.exercise_name; 
                vm.row5.reps = response5.reps;

                // vm.level = response.level;
                // vm.exercise = response.exercise; 
                // vm.weight = response.weight;
                // vm.rpe = response.rpe; 
                // vm.tempo = response.tempo; 
            });
        }

        $(document).ready(function(){
            $("#datepicker").on("change",function() {
                var newDate = $(this).val();
                $( "#date_text" ).text(newDate);
                updateTempDate(); 
                console.log(vm); 
            })

        });


    });
</script>


<style>


</style>


